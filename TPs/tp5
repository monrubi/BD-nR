--a
SELECT nomcomp, cd
from cos://us-geo/fpedcli/Clientes.csv
where nomcont < 'D'
order by cd desc

--b 
select pais, region, nomcomp 
from cos://us-geo/rpedcli/Proveedores.csv 
where idprov in 
  (select idprov 
  from cos://us-geo/rpedcli/Proveedores.csv 
  where nomcomp like 'M%' or nomcomp like 'm%' 
  order by nomcomp 
  limit 5) 
order by pais asc, region desc

--c
SELECT nomp, precioUnidad*cant as monto
from cos://us-geo/fpedcli/Productos.csv as prod, 
  cos://us-geo/fpedcli/DetallePedidos.csv as det, 
   cos://us-geo/fpedcli/Pedidos.csv as ped
where prod.idp = det.idp and det.idped=ped.idped 
  and month(ped.fechaped) = 11 
  and year(ped.fechaped) in (
  	select if(month(current_date)>11,year(current_date),year(current_date)-1)
	)

--d
select nomp
from cos://us-geo/mpedcli/Productos.csv
where idp not in (
  select prod.idp 
  from cos://us-geo/mpedcli/Productos.csv as prod,
  cos://us-geo/mpedcli/DetallePedidos.csv as dp,
  cos://us-geo/mpedcli/Pedidos_ddmmaaaa.csv as ped
  where prod.idp = dp.idp and dp.idped = ped.idped and
  month(fechaped)>0 and month(fechaped)<4 and year(fechaped) = year(current_date())
  )

--e 
SELECT nomcomp, nomcont
from cos://us-geo/fpedcli/Proveedores.csv 
where idprov not in (
  select idprov
  from cos://us-geo/fpedcli/Productos.csv as prod, 
  cos://us-geo/fpedcli/Categorias.csv as cat
  where prod.idcat = cat.idcat and nomcat = 'Lacteos'
  )

--f
SELECT Nombre, Apellidos, count(idPed)
from cos://us-geo/fpedcli/Empleados.csv as emp,
 cos://us-geo/fpedcli/Pedidos.csv as ped
where emp.idEmpleado = ped.idEmp and year(fechaped)= year(current_date)-2
group by Nombre, Apellidos
order by count(idPed) desc
limit 3
